<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>diameter_codec (diameter) -  - erldocs.com (Erlang Documentation)</title>
    <link rel="search" type="application/opensearchdescription+xml" title="erldocs" href="/search.xml"/>
    <link type="text/css" rel="stylesheet" href="../erldocs.css"/>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_require', 'inpage_linkid', '//www.google-analytics.com/plugins/ga/inpage_linkid.js']);
      _gaq.push(['_setAccount', 'UA-44246018-1']);
      _gaq.push(['_setDomainName', 'erldocs.com']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        


&lt;h1&gt;diameter_codec&lt;/h1&gt;
&lt;h2 class=&quot;modsummary&quot;&gt;Decode and encode of Diameter messages.&lt;/h2&gt;

&lt;div class=&quot;description&quot;&gt;

&lt;p&gt;
Incoming Diameter messages are decoded from binary() before being
communicated to &lt;a href=&quot;diameter_app.html&quot; class=&quot;seealso&quot;&gt;diameter_app(3)&lt;/a&gt; callbacks.
Similarly, outgoing Diameter messages are encoded into binary() before
being passed to the appropriate &lt;a href=&quot;diameter_transport.html&quot; class=&quot;seealso&quot;&gt;diameter_transport(3)&lt;/a&gt; module for
transmission.
The functions in this module implement this encode/decode.&lt;/p&gt;

&lt;div class=&quot;note&quot;&gt;&lt;h2&gt;Note!&lt;/h2&gt;
&lt;p&gt;
Calls to this module are made by diameter itself as a consequence of
configuration passed to &lt;a href=&quot;diameter.html#start_service-2&quot; class=&quot;seealso&quot;&gt;diameter:start_service/2&lt;/a&gt;.
The encode/decode functions may also be useful for other purposes (eg.
test) but the diameter user does not need to call them explicitly when
sending and receiving messages using &lt;a href=&quot;diameter.html#call-4&quot; class=&quot;seealso&quot;&gt;diameter:call/4&lt;/a&gt; and the callback
interface documented in &lt;a href=&quot;diameter_app.html&quot; class=&quot;seealso&quot;&gt;diameter_app(3)&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;
The &lt;a href=&quot;#header&quot; class=&quot;seealso&quot;&gt;header()&lt;/a&gt; and &lt;a href=&quot;#packet&quot; class=&quot;seealso&quot;&gt;packet()&lt;/a&gt; records below
are defined in diameter.hrl, which can be included as follows.&lt;/p&gt;

&lt;pre class=&quot;sh_erlang&quot;&gt;
-include_lib(&quot;diameter/include/diameter.hrl&quot;).
&lt;/pre&gt;

&lt;p&gt;
Application-specific records are defined in the hrl
files resulting from dictionary file compilation.&lt;/p&gt;

&lt;/div&gt;

&lt;div class=&quot;section&quot;&gt;
&lt;h4&gt;DATA TYPES&lt;/h4&gt;

&lt;p  /&gt;

&lt;taglist&gt;

&lt;span id=&quot;integers&quot;&gt; &lt;/span&gt;

&lt;dt&gt;&lt;code&gt;uint8()&amp;nbsp; = 0..255&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;uint24() = 0..16777215&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;uint32() = 0..4294967295&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
8-bit, 24-bit and 32-bit integers occurring in Diameter and AVP
headers.&lt;/p&gt;
&lt;/item&gt;

&lt;span id=&quot;avp&quot;&gt; &lt;/span&gt;

&lt;dt&gt;&lt;code&gt;avp() = #diameter_avp{}&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The application-neutral representation of an AVP.
Primarily intended for use by relay applications that need to handle
arbitrary Diameter applications.
A service implementing a specific Diameter application
(for which it configures a dictionary) can manipulate values of type
&lt;a href=&quot;#message&quot; class=&quot;seealso&quot;&gt;message()&lt;/a&gt; instead.&lt;/p&gt;

&lt;p&gt;
Fields have the following types.&lt;/p&gt;

&lt;taglist&gt;

&lt;dt&gt;&lt;code&gt;code = uint32()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;is_mandatory = boolean()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;need_encryption = boolean()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;vendor_id = uint32() | undefined&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
Values in the AVP header, corresponding to AVP Code, the M flag, P
flags and Vendor-ID respectively.
A Vendor-ID other than &lt;code&gt;undefined&lt;/code&gt; implies a set V flag.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;data = iolist()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The data bytes of the AVP.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;name = atom()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The name of the AVP as defined in the dictionary file in question, or
&lt;code&gt;undefined&lt;/code&gt; if the AVP is unknown to the dictionary file in
question.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;value = term()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The decoded value of an AVP.
Will be &lt;code&gt;undefined&lt;/code&gt; on decode if the data bytes could
not be decoded or the AVP is unknown.
The type of a decoded value is as document in &lt;a href=&quot;diameter_dict.html#DATA_TYPES&quot; class=&quot;seealso&quot;&gt;diameter_dict(4)&lt;/a&gt;.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;type = atom()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The type of the AVP as specified in the dictionary file in question
(or one it inherits).
Possible types are &lt;code&gt;undefined&lt;/code&gt; and the Diameter types:
&lt;code&gt;OctetString&lt;/code&gt;, &lt;code&gt;Integer32&lt;/code&gt;, &lt;code&gt;Integer64&lt;/code&gt;,
&lt;code&gt;Unsigned32&lt;/code&gt;, &lt;code&gt;Unsigned64&lt;/code&gt;, &lt;code&gt;Float32&lt;/code&gt;, &lt;code&gt;Float64&lt;/code&gt;,
&lt;code&gt;Grouped&lt;/code&gt;, &lt;code&gt;Enumerated&lt;/code&gt;, &lt;code&gt;Address&lt;/code&gt;, &lt;code&gt;Time&lt;/code&gt;,
&lt;code&gt;UTF8String&lt;/code&gt;, &lt;code&gt;DiameterIdentity&lt;/code&gt;, &lt;code&gt;DiameterURI&lt;/code&gt;,
&lt;code&gt;IPFilterRule&lt;/code&gt; and &lt;code&gt;QoSFilterRule&lt;/code&gt;.&lt;/p&gt;
&lt;/item&gt;

&lt;/taglist&gt;

&lt;/item&gt;

&lt;span id=&quot;dictionary&quot;&gt; &lt;/span&gt;

&lt;dt&gt;&lt;code&gt;dictionary() = module()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;

&lt;p&gt;
The name of a generated dictionary module as generated by &lt;a href=&quot;diameterc.html&quot; class=&quot;seealso&quot;&gt;diameterc(1)&lt;/a&gt;
or &lt;a href=&quot;diameter_make.html#codec-2&quot; class=&quot;seealso&quot;&gt;diameter_make:codec/2&lt;/a&gt;.
The interface provided by a dictionary module is an
implementation detail that may change.&lt;/p&gt;
&lt;/item&gt;

&lt;span id=&quot;header&quot;&gt; &lt;/span&gt;

&lt;dt&gt;&lt;code&gt;header() = #diameter_header{}&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The record representation of the Diameter header.
Values in a &lt;a href=&quot;#packet&quot; class=&quot;seealso&quot;&gt;packet()&lt;/a&gt; returned by &lt;a href=&quot;#decode-2&quot; class=&quot;seealso&quot;&gt;decode/2&lt;/a&gt; are as extracted from the
incoming message.
Values set in an &lt;a href=&quot;#packet&quot; class=&quot;seealso&quot;&gt;packet()&lt;/a&gt; passed to &lt;a href=&quot;#encode-2&quot; class=&quot;seealso&quot;&gt;encode/2&lt;/a&gt; are preserved in the
encoded binary(), with the exception of &lt;code&gt;length&lt;/code&gt;, &lt;code&gt;cmd_code&lt;/code&gt;
and &lt;code&gt;application_id&lt;/code&gt;, all of which are determined by the
&lt;a href=&quot;#dictionary&quot; class=&quot;seealso&quot;&gt;dictionary()&lt;/a&gt; in question.&lt;/p&gt;

&lt;div class=&quot;note&quot;&gt;&lt;h2&gt;Note!&lt;/h2&gt;
&lt;p&gt;
It is not necessary to set header fields explicitly in outgoing
messages as diameter itself will set appropriate values.
Setting inappropriate values can be useful for test purposes.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;
Fields have the following types.&lt;/p&gt;

&lt;taglist&gt;

&lt;dt&gt;&lt;code&gt;version = uint8()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;length = uint24()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;cmd_code = uint24()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;application_id = uint32()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;hop_by_hop_id = uint32()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;end_to_end_id = uint32()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
Values of the Version, Message Length, Command-Code, Application-ID,
Hop-by-Hop Identifier and End-to-End Identifier fields of the Diameter
header.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;is_request = boolean()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;is_proxiable = boolean()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;is_error = boolean()&lt;/code&gt;&lt;/dt&gt;
&lt;dt&gt;&lt;code&gt;is_retransmitted = boolean()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
Values corresponding to the R(equest), P(roxiable), E(rror)
and T(Potentially re-transmitted message) flags of the Diameter
header.&lt;/p&gt;
&lt;/item&gt;

&lt;/taglist&gt;

&lt;/item&gt;

&lt;span id=&quot;message&quot;&gt; &lt;/span&gt;

&lt;dt&gt;&lt;code&gt;message() = record() | list()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The representation of a Diameter message as passed to
&lt;a href=&quot;diameter.html#call-4&quot; class=&quot;seealso&quot;&gt;diameter:call/4&lt;/a&gt; or returned from a &lt;a href=&quot;../diameter_app#Mod/handle_request-3.html&quot; class=&quot;seealso&quot;&gt;handle_request/3&lt;/a&gt; callback.
The record representation is as outlined in &lt;a href=&quot;diameter_dict.html#MESSAGE_RECORDS&quot; class=&quot;seealso&quot;&gt;diameter_dict(4)&lt;/a&gt;:
a message as defined in a dictionary file is encoded as a record with
one field for each component AVP.
Equivalently, a message can also be encoded as a list whose head is
the atom-valued message name (as specified in the relevant dictionary
file) and whose tail is a list of &lt;code&gt;{AvpName, AvpValue}&lt;/code&gt; pairs.&lt;/p&gt;

&lt;p&gt;
Another list-valued representation allows a message to be specified
as a list whose head is a &lt;a href=&quot;#header&quot; class=&quot;seealso&quot;&gt;header()&lt;/a&gt; and whose tail is an &lt;a href=&quot;#avp&quot; class=&quot;seealso&quot;&gt;avp()&lt;/a&gt; list.
This representation is used by diameter itself when relaying requests
as directed by the return value of a &lt;a href=&quot;../diameter_app#Mod/handle_request-3.html&quot; class=&quot;seealso&quot;&gt;handle_request/3&lt;/a&gt; callback.
It differs from the other other two in that it bypasses the checks for
messages that do not agree with their definitions in the dictionary in
question: messages are sent exactly as specified.&lt;/p&gt;

&lt;/item&gt;

&lt;span id=&quot;packet&quot;&gt; &lt;/span&gt;

&lt;dt&gt;&lt;code&gt;packet() = #diameter_packet{}&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
A container for incoming and outgoing Diameter messages.
Fields have the following types.&lt;/p&gt;

&lt;taglist&gt;

&lt;dt&gt;&lt;code&gt;header = &lt;a href=&quot;#header&quot; class=&quot;seealso&quot;&gt;header()&lt;/a&gt; | undefined&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The Diameter header of the message.
Can be (and typically should be) &lt;code&gt;undefined&lt;/code&gt; for an outgoing
message in a non-relay application, in which case diameter provides
appropriate values.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;avps = [&lt;a href=&quot;#avp&quot; class=&quot;seealso&quot;&gt;avp()&lt;/a&gt;] | undefined&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The AVPs of the message.
Ignored for an outgoing message if the &lt;code&gt;msg&lt;/code&gt; field is set to a
value other than &lt;code&gt;undefined&lt;/code&gt;.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;msg = &lt;a href=&quot;#message&quot; class=&quot;seealso&quot;&gt;message()&lt;/a&gt; | undefined&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The incoming/outgoing message.
For an incoming message, a record if the message can be
decoded in a non-relay application, &lt;code&gt;undefined&lt;/code&gt; otherwise.
For an outgoing message, setting a &lt;code&gt;[&lt;a href=&quot;#header&quot; class=&quot;seealso&quot;&gt;header()&lt;/a&gt; | &lt;a href=&quot;#avp&quot; class=&quot;seealso&quot;&gt;avp()&lt;/a&gt;]&lt;/code&gt; list is
equivalent to setting the &lt;code&gt;header&lt;/code&gt; and &lt;code&gt;avps&lt;/code&gt; fields to the
corresponding values.&lt;/p&gt;

&lt;div class=&quot;warning&quot;&gt;&lt;h2&gt;Warning!&lt;/h2&gt;
&lt;p&gt;
A record-valued &lt;code&gt;msg&lt;/code&gt; field does &lt;b&gt;not&lt;/b&gt; imply an absence of
decode errors.
The &lt;code&gt;errors&lt;/code&gt; field should also be examined.&lt;/p&gt;
&lt;/div&gt;

&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;bin = binary()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
The incoming message prior to encode or the outgoing message after
encode.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;errors = [5000..5999 | {5000..5999, avp()}]&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
Errors detected at decode of an incoming message, as identified by
a corresponding 5xxx series Result-Code (Permanent Failures).
For an incoming request, these should be used to formulate an
appropriate answer as documented for the &lt;a href=&quot;../diameter_app#Mod/handle_request-3.html&quot; class=&quot;seealso&quot;&gt;handle_request/3&lt;/a&gt;
callback in &lt;a href=&quot;diameter_app.html&quot; class=&quot;seealso&quot;&gt;diameter_app(3)&lt;/a&gt;.
For an incoming answer, the &lt;a href=&quot;diameter.html#application_opt&quot; class=&quot;seealso&quot;&gt;diameter:application_opt()&lt;/a&gt;
&lt;code&gt;answer_errors&lt;/code&gt; determines the behaviour.&lt;/p&gt;
&lt;/item&gt;

&lt;dt&gt;&lt;code&gt;transport_data = term()&lt;/code&gt;&lt;/dt&gt;
&lt;item&gt;
&lt;p&gt;
An arbitrary term of meaning only to the transport process in
question, as documented in &lt;a href=&quot;diameter_transport.html&quot; class=&quot;seealso&quot;&gt;diameter_transport(3)&lt;/a&gt;.&lt;/p&gt;
&lt;/item&gt;

&lt;/taglist&gt;

&lt;/item&gt;

&lt;/taglist&gt;

&lt;/div&gt;

&lt;div class=&quot;functions&quot;&gt;&lt;h4&gt;Functions&lt;/h4&gt;&lt;hr  /&gt;

&lt;div class=&quot;function&quot;&gt;
&lt;h3 id=&quot;decode/2&quot;&gt;decode(Mod, Bin) -&amp;gt; Pkt&lt;/h3&gt;

&lt;ul class=&quot;type&quot;&gt;
&lt;li&gt;&lt;code&gt;Mod = &lt;a href=&quot;#dictionary&quot; class=&quot;seealso&quot;&gt;dictionary()&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Bin = binary()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Pkt = &lt;a href=&quot;#packet&quot; class=&quot;seealso&quot;&gt;packet()&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;description&quot;&gt;

&lt;p&gt;
Decode a Diameter message.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;function&quot;&gt;
&lt;h3 id=&quot;encode/2&quot;&gt;encode(Mod, Msg) -&amp;gt; Pkt&lt;/h3&gt;

&lt;ul class=&quot;type&quot;&gt;
&lt;li&gt;&lt;code&gt;Mod = &lt;a href=&quot;#dictionary&quot; class=&quot;seealso&quot;&gt;dictionary()&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Msg = &lt;a href=&quot;#message&quot; class=&quot;seealso&quot;&gt;message()&lt;/a&gt; | &lt;a href=&quot;#packet&quot; class=&quot;seealso&quot;&gt;packet()&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Pkt = &lt;a href=&quot;#packet&quot; class=&quot;seealso&quot;&gt;packet()&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;description&quot;&gt;

&lt;p&gt;
Encode a Diameter message.
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;section&quot;&gt;
&lt;h4&gt;SEE ALSO&lt;/h4&gt;

&lt;p&gt;
&lt;a href=&quot;diameterc.html&quot; class=&quot;seealso&quot;&gt;diameterc(1)&lt;/a&gt;, &lt;a href=&quot;diameter_app.html&quot; class=&quot;seealso&quot;&gt;diameter_app(3)&lt;/a&gt;, &lt;a href=&quot;diameter_dict.html&quot; class=&quot;seealso&quot;&gt;diameter_dict(4)&lt;/a&gt;, &lt;a href=&quot;diameter_make.html&quot; class=&quot;seealso&quot;&gt;diameter_make(3)&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;


      </div>
      <div id="funwrapper">
        <a id="viewfuns">View Functions</a>
        &lt;ul id=&quot;funs&quot;&gt;&lt;li&gt;&lt;a href=&quot;#decode/2&quot;&gt;decode/2&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;#encode/2&quot;&gt;encode/2&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;
      </div>
    </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="../jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="../erldocs.js"></script>
  </body>
</html>
